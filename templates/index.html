<!DOCTYPE html>
<html>
<head><title>NDVI</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>#m{height:100vh;}</style></head>

<body>
<div id="m"></div>

<!-- Legend Container -->
<div id="legend" style="position:absolute; bottom:20px; right:10px; background:white; padding:10px; border-radius:5px; box-shadow:0 0 10px rgba(0,0,0,0.2); z-index:1000; font-size:12px;">
    <strong>NDVI Legend</strong>
    <div style="height:10px; width:100%; background:linear-gradient(to right, #d73027, #fc8d59, #fee08b, #d9ef8b, #91cf60, #1a9850); margin:5px 0;"></div>
    <div style="display:flex; justify-content:space-between;">
        <span>-1.0</span>
        <span>0.0</span>
        <span>+1.0</span>
    </div>
    <div style="margin-top:5px;">
        <div>Water/Snow • Bare Soil • Sparse • Moderate • Dense Vegetation</div>
    </div>
</div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('m').setView([-18.7, 29.5], 7);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap'
}).addTo(map);
// Hardcoded image bounds for Zimbabwe (adjust if needed)
const SADC = L.latLngBounds([[ -35.00446428571232, 10.995535714285715], [ -7.995535714285042, 41.00446428571284 ]]);
const zimBounds = L.latLngBounds([[ -23.00446426, 24.995535714], [ -14.995535714, 34.004464257 ]]);
// Use your Flask API endpoint (ensure Flask is running!)
L.imageOverlay('http://localhost:5000/api/colored_ndvi/2001-01-01', 
               zimBounds, {opacity:0.7}).addTo(map);

fetch('/static/data/zim_admin1.geojson')
    .then(response => response.json())
    .then(data => {
        L.geoJSON(data, {
            style: {
                color: '#FF0000',
                weight: 1,
                fillOpacity: 0
            },
            onEachFeature: function(feature, layer) {
                // Show province name on hover
                if (feature.properties && feature.properties.ADM1_EN) {
                    layer.bindTooltip(feature.properties.ADM1_EN);
                }
            }
        }).addTo(map);
    });

</script>
</body>
</html>