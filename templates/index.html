<!DOCTYPE html>
<html>
<head><title>NDVI</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<style>#m{height:100vh;}</style></head>

<body>
<div id="m"></div>

<!-- Legend Container -->
<div id="legend"
     style="
        position:absolute;
        bottom:20px;
        right:10px;
        background:white;
        padding:10px;
        border-radius:5px;
        box-shadow:0 0 10px rgba(0,0,0,0.2);
        z-index:1000;
        font-size:12px;
        line-height:1.4;
     ">
  <strong>Rainfall (mm)</strong>

  <div style="margin-top:6px;">
    <div style="display:flex; align-items:center;">
      <span style="width:18px;height:12px;background:#deebf7;display:inline-block;margin-right:6px;"></span>
      0 – 25 (Very Low)
    </div>

    <div style="display:flex; align-items:center;">
      <span style="width:18px;height:12px;background:#9ecae1;display:inline-block;margin-right:6px;"></span>
      25 – 75 (Low)
    </div>

    <div style="display:flex; align-items:center;">
      <span style="width:18px;height:12px;background:#3182bd;display:inline-block;margin-right:6px;"></span>
      75 – 150 (Moderate)
    </div>

    <div style="display:flex; align-items:center;">
      <span style="width:18px;height:12px;background:#08306b;display:inline-block;margin-right:6px;"></span>
      150 – 250 (High)
    </div>
  </div>
</div>

</div>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('m').setView([-18.7, 29.5], 7);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '© OpenStreetMap'
}).addTo(map);
// Hardcoded image bounds for Zimbabwe (adjust if needed)
const zimBounds = L.latLngBounds([[ -35.00446428571232, 10.995535714285715], [ -7.995535714285042, 41.00446428571284 ]]);
//const zimBounds = L.latLngBounds([[ -23.00446426, 24.995535714], [ -14.995535714, 34.004464257 ]]);
// Use your Flask API endpoint (ensure Flask is running!)
L.imageOverlay('http://localhost:5000/api/classified_rainfall_tif/2001-12-11', 
               zimBounds, {opacity:0.7}).addTo(map);

fetch('/static/data/zim_admin1.geojson')
    .then(response => response.json())
    .then(data => {
        L.geoJSON(data, {
            style: {
                color: '#FF0000',
                weight: 1,
                fillOpacity: 0
            },
            onEachFeature: function(feature, layer) {
                // Show province name on hover
                if (feature.properties && feature.properties.ADM1_EN) {
                    layer.bindTooltip(feature.properties.ADM1_EN);
                }
            }
        }).addTo(map);
    });

</script>
</body>
</html>